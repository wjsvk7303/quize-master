<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="당신의 상식 수준을 테스트하는 퀴즈 게임. 한국사, 과학, 지리, 예술과 문화 4개 카테고리, 40개 문제로 구성된 퀴즈 마스터">
    <title>상식 퀴즈 게임 - Quiz Master</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="background-overlay" aria-hidden="true"></div>

    <!-- Skip to main content link for keyboard users -->
    <a href="#main-content" class="skip-link">메인 콘텐츠로 건너뛰기</a>

    <!-- Screen reader announcements -->
    <div id="sr-announcements" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>

    <!-- Help button (always visible) -->
    <button id="help-btn" class="help-button" aria-label="도움말 보기" title="도움말 및 키보드 단축키 (F1)">
        <span aria-hidden="true">?</span>
    </button>

    <!-- Loading overlay -->
    <div id="loading-overlay" class="loading-overlay" role="status" aria-live="polite">
        <div class="loading-overlay-content">
            <div class="loading-spinner" aria-hidden="true"></div>
            <p class="loading-text">문제 로드 중...</p>
        </div>
    </div>

    <!-- Error overlay -->
    <div id="error-overlay" class="error-overlay hidden" role="alert" aria-live="assertive">
        <div class="error-overlay-content">
            <div class="error-icon" aria-hidden="true">!</div>
            <h2 class="error-title">데이터 로드 실패</h2>
            <p id="error-message" class="error-message-text">문제 데이터를 불러오지 못했습니다.</p>
            <button id="retry-load-btn" class="btn-primary error-retry-btn" aria-label="다시 시도">
                <span class="btn-text">다시 시도</span>
                <span class="btn-icon" aria-hidden="true">🔄</span>
            </button>
        </div>
    </div>

    <div class="container" id="main-content">
        <!-- 시작 화면 -->
        <div id="start-screen" class="screen active" role="main" aria-labelledby="main-title">
            <div class="welcome-header">
                <div class="logo-container">
                    <div class="logo-icon" aria-hidden="true">🎯</div>
                    <h1 id="main-title" class="main-title">Quiz Master</h1>
                </div>
                <p class="subtitle">당신의 상식 수준을 테스트하세요</p>
            </div>

            <div class="name-input-section">
                <label for="user-name" class="input-label">이름을 입력해주세요</label>
                <input
                    type="text"
                    id="user-name"
                    class="name-input"
                    placeholder="홍길동"
                    maxlength="20"
                    autocomplete="off"
                    aria-required="true"
                    aria-describedby="name-help"
                    aria-invalid="false"
                >
                <div id="name-help" class="input-help">20자 이내로 입력하세요. 엔터키로 시작할 수 있습니다.</div>
                <div id="name-error" class="input-error hidden" role="alert" aria-live="assertive"></div>
            </div>

            <div class="category-selection">
                <h2 class="section-title">카테고리 선택</h2>
                <div class="category-grid" role="group" aria-label="퀴즈 카테고리">
                    <button class="category-card" data-category="all" aria-label="전체 카테고리 선택 - 40문제" aria-pressed="false">
                        <div class="category-icon" aria-hidden="true">🌟</div>
                        <div class="category-name">전체</div>
                        <div class="category-count">40문제</div>
                    </button>
                    <button class="category-card" data-category="한국사" aria-label="한국사 카테고리 선택 - 10문제" aria-pressed="false">
                        <div class="category-icon" aria-hidden="true">📚</div>
                        <div class="category-name">한국사</div>
                        <div class="category-count">10문제</div>
                    </button>
                    <button class="category-card" data-category="과학" aria-label="과학 카테고리 선택 - 10문제" aria-pressed="false">
                        <div class="category-icon" aria-hidden="true">🔬</div>
                        <div class="category-name">과학</div>
                        <div class="category-count">10문제</div>
                    </button>
                    <button class="category-card" data-category="지리" aria-label="지리 카테고리 선택 - 10문제" aria-pressed="false">
                        <div class="category-icon" aria-hidden="true">🗺️</div>
                        <div class="category-name">지리</div>
                        <div class="category-count">10문제</div>
                    </button>
                    <button class="category-card" data-category="예술과 문화" aria-label="예술과 문화 카테고리 선택 - 10문제" aria-pressed="false">
                        <div class="category-icon" aria-hidden="true">🎨</div>
                        <div class="category-name">예술과 문화</div>
                        <div class="category-count">10문제</div>
                    </button>
                </div>
            </div>

            <div class="mode-selection">
                <h2 class="section-title">문제 모드</h2>
                <div class="mode-toggle" role="group" aria-label="문제 모드 선택">
                    <button class="mode-card selected" data-mode="local" aria-pressed="true">
                        <div class="mode-icon" aria-hidden="true">📋</div>
                        <div class="mode-name">기존 문제</div>
                    </button>
                    <button class="mode-card" data-mode="ai" aria-pressed="false">
                        <div class="mode-icon" aria-hidden="true">🤖</div>
                        <div class="mode-name">AI 문제</div>
                    </button>
                </div>
            </div>

            <button id="start-btn" class="btn-primary" aria-label="퀴즈 시작하기">
                <span class="btn-text">시작하기</span>
                <span class="btn-icon" aria-hidden="true">→</span>
            </button>

            <button id="view-ranking-btn" class="btn-secondary" style="margin-top: 10px;" aria-label="명예의 전당 보기">
                <span class="btn-text">순위 보기</span>
                <span class="btn-icon" aria-hidden="true">🏆</span>
            </button>
        </div>

        <!-- 퀴즈 화면 -->
        <div id="quiz-screen" class="screen" role="main" aria-labelledby="question-text">
            <div class="quiz-header">
                <div class="player-info">
                    <div class="player-avatar" aria-hidden="true">👤</div>
                    <div class="player-name" id="player-display-name" aria-label="플레이어">플레이어</div>
                </div>
                <div class="score-display" role="status" aria-live="polite">
                    <div class="score-label">점수</div>
                    <div class="score-value" id="current-score" aria-label="현재 점수">0</div>
                </div>
            </div>

            <div class="progress-section">
                <div class="progress-info">
                    <span class="progress-text" role="status" aria-live="polite">
                        문제 <span id="current-question">1</span> / <span id="total-questions">40</span>
                    </span>
                </div>
                <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="퀴즈 진행률">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
            </div>

            <div class="quiz-content">
                <div class="question-card">
                    <div class="category-badge" id="question-category" aria-label="문제 카테고리"></div>
                    <h2 id="question-text" class="question-text" tabindex="-1"></h2>
                </div>

                <div id="options-container" class="options-container" role="radiogroup" aria-labelledby="question-text">
                    <!-- 옵션들이 동적으로 추가됩니다 -->
                </div>

                <div id="explanation" class="explanation-box hidden" role="region" aria-label="정답 해설">
                    <div class="explanation-header">
                        <span class="explanation-icon" aria-hidden="true">💡</span>
                        <span class="explanation-title">해설</span>
                    </div>
                    <p id="explanation-text" class="explanation-text"></p>
                </div>

                <button id="next-btn" class="btn-primary hidden" aria-label="다음 문제로 이동">
                    <span class="btn-text">다음 문제</span>
                    <span class="btn-icon" aria-hidden="true">→</span>
                    <span class="keyboard-hint" aria-hidden="true">Enter</span>
                </button>
            </div>
        </div>

        <!-- 결과 화면 -->
        <div id="result-screen" class="screen" role="main" aria-labelledby="result-title">
            <div class="result-header">
                <div class="result-icon" id="result-emoji" aria-hidden="true">🎉</div>
                <h1 id="result-title" class="result-title">퀴즈 완료!</h1>
                <p class="result-subtitle" id="result-player-name" role="status"></p>
            </div>

            <div class="result-content">
                <div class="final-score-card">
                    <div class="score-circle">
                        <svg class="score-ring" viewBox="0 0 200 200" aria-hidden="true">
                            <circle class="score-ring-bg" cx="100" cy="100" r="85" />
                            <circle id="score-ring-progress" class="score-ring-progress" cx="100" cy="100" r="85" />
                        </svg>
                        <div class="score-inner">
                            <div class="final-score-value" id="final-score" aria-label="최종 점수">0</div>
                            <div class="final-score-label">점</div>
                        </div>
                    </div>
                    <div class="score-details" role="status">
                        <div class="score-ratio">
                            <span id="correct-count">0</span> / <span id="total-count">0</span> 정답
                        </div>
                        <div class="grade-badge" id="grade-badge" aria-label="등급"></div>
                    </div>
                </div>

                <div class="result-message" id="result-message" role="status">
                    <!-- 결과 메시지가 동적으로 추가됩니다 -->
                </div>

                <div class="category-results-section">
                    <h3 class="category-results-title">카테고리별 정답률</h3>
                    <div id="category-results" class="category-results-grid" role="list">
                        <!-- 카테고리별 결과가 동적으로 추가됩니다 -->
                    </div>
                </div>
            </div>

            <div class="result-buttons">
                <button id="retry-btn" class="btn-primary" aria-label="퀴즈 다시 시작하기">
                    <span class="btn-text">다시 도전</span>
                    <span class="btn-icon" aria-hidden="true">🔄</span>
                </button>
                <button id="view-ranking-result-btn" class="btn-secondary" aria-label="명예의 전당 보기">
                    <span class="btn-text">순위 보기</span>
                    <span class="btn-icon" aria-hidden="true">🏆</span>
                </button>
            </div>
            <button id="home-btn" class="btn-secondary" style="margin-top: 15px;" aria-label="홈으로 돌아가기">
                <span class="btn-text">홈으로</span>
            </button>
        </div>
    </div>

    <!-- 순위 모달 -->
    <div id="ranking-modal" class="modal" role="dialog" aria-labelledby="ranking-modal-title" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="ranking-modal-title" class="modal-title"><span aria-hidden="true">🏆</span> 명예의 전당</h2>
                <button id="close-modal" class="close-btn" aria-label="모달 닫기" title="닫기 (Esc)">×</button>
            </div>
            <div class="modal-body">
                <div id="ranking-list" class="ranking-list" role="list">
                    <!-- 순위가 동적으로 추가됩니다 -->
                </div>
                <div id="empty-ranking" class="empty-ranking hidden">
                    <p>아직 기록된 순위가 없습니다.</p>
                    <p>첫 번째 도전자가 되어보세요!</p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="clear-ranking-btn" class="btn-danger" aria-label="순위 기록 초기화">
                    <span class="btn-text">순위 초기화</span>
                    <span class="btn-icon" aria-hidden="true">🗑️</span>
                </button>
                <button id="close-modal-btn" class="btn-secondary" aria-label="모달 닫기">
                    <span class="btn-text">닫기</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Confirmation modal -->
    <div id="confirm-modal" class="modal" role="dialog" aria-labelledby="confirm-modal-title" aria-modal="true">
        <div class="modal-content confirm-modal-content">
            <div class="modal-header">
                <h2 id="confirm-modal-title" class="modal-title">확인</h2>
                <button id="confirm-close" class="close-btn" aria-label="확인 창 닫기">×</button>
            </div>
            <div class="modal-body">
                <p id="confirm-message" class="confirm-message"></p>
            </div>
            <div class="modal-footer">
                <button id="confirm-yes" class="btn-danger" aria-label="확인">
                    <span class="btn-text">확인</span>
                </button>
                <button id="confirm-no" class="btn-secondary" aria-label="취소">
                    <span class="btn-text">취소</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Help modal -->
    <div id="help-modal" class="modal" role="dialog" aria-labelledby="help-modal-title" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="help-modal-title" class="modal-title">도움말 및 키보드 단축키</h2>
                <button id="help-close" class="close-btn" aria-label="도움말 닫기">×</button>
            </div>
            <div class="modal-body">
                <section class="help-section">
                    <h3>게임 방법</h3>
                    <ul>
                        <li>이름을 입력하고 원하는 카테고리를 선택하세요</li>
                        <li>각 문제에 대해 정답을 선택하면 즉시 결과를 확인할 수 있습니다</li>
                        <li>모든 문제를 풀면 최종 점수와 등급이 표시됩니다</li>
                        <li>정답 1개당 10점을 획득합니다</li>
                    </ul>
                </section>
                <section class="help-section">
                    <h3>키보드 단축키</h3>
                    <dl class="keyboard-shortcuts">
                        <div class="shortcut-item">
                            <dt><kbd>F1</kbd></dt>
                            <dd>도움말 보기</dd>
                        </div>
                        <div class="shortcut-item">
                            <dt><kbd>Enter</kbd></dt>
                            <dd>퀴즈 시작 / 다음 문제</dd>
                        </div>
                        <div class="shortcut-item">
                            <dt><kbd>1-4</kbd></dt>
                            <dd>답변 선택 (1번~4번)</dd>
                        </div>
                        <div class="shortcut-item">
                            <dt><kbd>Esc</kbd></dt>
                            <dd>모달 닫기</dd>
                        </div>
                        <div class="shortcut-item">
                            <dt><kbd>Tab</kbd></dt>
                            <dd>다음 요소로 이동</dd>
                        </div>
                        <div class="shortcut-item">
                            <dt><kbd>Shift + Tab</kbd></dt>
                            <dd>이전 요소로 이동</dd>
                        </div>
                    </dl>
                </section>
                <section class="help-section">
                    <h3>접근성 기능</h3>
                    <ul>
                        <li>스크린 리더 지원: 모든 요소에 적절한 레이블이 제공됩니다</li>
                        <li>키보드 전용 탐색: 마우스 없이 모든 기능을 사용할 수 있습니다</li>
                        <li>고대비 모드: 명확한 색상 대비로 가독성을 높였습니다</li>
                        <li>큰 터치 영역: 모바일에서 쉽게 탭할 수 있도록 최적화되었습니다</li>
                    </ul>
                </section>
            </div>
            <div class="modal-footer">
                <button id="help-ok" class="btn-primary" aria-label="확인">
                    <span class="btn-text">확인</span>
                </button>
            </div>
        </div>
    </div>

    <!-- First-time welcome overlay -->
    <div id="welcome-overlay" class="welcome-overlay hidden" role="dialog" aria-labelledby="welcome-overlay-title" aria-modal="true">
        <div class="welcome-overlay-content">
            <div class="welcome-overlay-header">
                <h2 id="welcome-overlay-title">Quiz Master에 오신 것을 환영합니다!</h2>
            </div>
            <div class="welcome-overlay-body">
                <div class="welcome-step">
                    <span class="step-number" aria-hidden="true">1</span>
                    <div class="step-content">
                        <h3>이름 입력</h3>
                        <p>상단에 이름을 입력하세요. 순위에 기록됩니다.</p>
                    </div>
                </div>
                <div class="welcome-step">
                    <span class="step-number" aria-hidden="true">2</span>
                    <div class="step-content">
                        <h3>카테고리 선택</h3>
                        <p>한국사, 과학, 지리, 예술과 문화 중 선택하거나 전체를 선택하세요.</p>
                    </div>
                </div>
                <div class="welcome-step">
                    <span class="step-number" aria-hidden="true">3</span>
                    <div class="step-content">
                        <h3>퀴즈 풀기</h3>
                        <p>각 문제에 답하고 즉시 정답을 확인하세요. 정답당 10점입니다.</p>
                    </div>
                </div>
                <div class="welcome-tip">
                    <p><strong>팁:</strong> <kbd>F1</kbd> 키를 눌러 언제든지 도움말을 볼 수 있습니다.</p>
                </div>
            </div>
            <div class="welcome-overlay-footer">
                <label class="welcome-checkbox">
                    <input type="checkbox" id="dont-show-welcome" aria-label="다시 보지 않기">
                    <span>다시 보지 않기</span>
                </label>
                <button id="welcome-start" class="btn-primary" aria-label="시작하기">
                    <span class="btn-text">시작하기</span>
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
